---
title: "Azure RMS の機能の詳細 | Azure RMS"
description: 
keywords: 
author: cabailey
manager: mbaldwin
ms.date: 06/02/2016
ms.topic: article
ms.prod: azure
ms.service: rights-management
ms.technology: techgroup-identity
ms.assetid: ed6c964e-4701-4663-a816-7c48cbcaf619
ms.reviewer: esaggese
ms.suite: ems
translationtype: Human Translation
ms.sourcegitcommit: 5d825d6c8b2c8b7a9c34ac940c5a08439a9ae562
ms.openlocfilehash: 505f2c94bb4fd056b4d2f51c147c6b0b84efac00


---


# Azure RMS の機能の 詳細

*適用対象: Azure Rights Management、Office 365*

Azure RMS の動作について理解しておく 1 つの重要な点は、Rights Management サービス (および Microsoft) は情報保護プロセスの一部としてユーザーのデータを見たり保存したりしないことです。 ユーザーが保護した情報は、ユーザーが Azure に明示的に保存したり、Azure に情報を保存する別のクラウド サービスを使用しない限り、Azure に送信されたり保存されたりすることはありません。 Azure RMS は、単純に、承認されたユーザーおよびサービス以外のものが文書のデータを読めないようにします。

-   データは、アプリケーション レベルで暗号化されており、そのドキュメントの承認済みの使用を定義するポリシーが含まれています。

-   保護されたドキュメントが、正当なユーザーによって使用されるとき、または承認されたサービスによって処理される場合は、ドキュメント内のデータの暗号化が解除され、ポリシーで定義されている権利が適用されます。

大まかに言えば、次の図でこのプロセスのしくみを確認できます。 秘密の調合が含まれるドキュメントは保護されていて、権限を持つユーザーまたはサービスは正常に開くことができます。 ドキュメントは、コンテンツ キー (この図で緑のキー) によって保護されています。 コンテンツ キーはドキュメントごとに一意であり、RMS テナント ルート キー (この図で赤色のキー) によって保護されているファイル ヘッダーに配置されます。 マイクロソフトがテナント キーを生成して管理することも、ユーザーが独自のテナント キーを生成して管理することもできます。

Azure RMS が暗号化および復号化、承認、制限の適用を行う保護プロセス全体を通じて、秘密の調合は Azure に送信されません。

![Azure RMS がファイルを保護する方法](../media/AzRMS_SecretColaFormula_final.png)

処理の詳細については、この記事の「[Azure RMS の動作のチュートリアル:初めての使用、コンテンツ保護、コンテンツ消費](#walkthrough-of-how-azure-rms-works-first-use-content-protection-content-consumption)」セクションを参照してください。

Azure RMS が使用するアルゴリズムおよびキー長に関する技術的詳細については、次のセクションを参照してください。

## Azure RMS で使用される暗号化の制御:アルゴリズムとキーの長さ
自分で RMS がどのように機能するかを知る必要がなくても、セキュリティ保護が業界標準であることを確認するために、使用している暗号化制御に関してたずねられることがあります。


|暗号化コントロール|Azure RMS での使用|
|-|-|
|アルゴリズム:AES<br /><br />キーの長さ: 128 ビットと 256 ビット [[1]](#footnote-1)|ドキュメントの保護|
|アルゴリズム:RSA<br /><br />キーの長さ:2048 ビット|キーの保護|
|SHA-256|証明書の署名|

###### 脚注 1: 

ファイルの拡張子が .ppdf のとき、またはファイルが保護されたテキスト ファイルまたはイメージ ファイル (.ptxt や .pjpg など) のときは、汎用的な保護およびネイティブ保護のために Rights Management 共有アプリケーションは 256 ビットを使用します。

暗号化キーの格納とセキュリティ保護のしくみ

- Azure RMS は、Azure RMS によって保護されているドキュメントまたは電子メールごとに、1 つの AES キー (コンテンツ キー) を作成します。このキーはドキュメントに埋め込まれ、ドキュメントの各エディションを通じて保持されます。 

- コンテンツ キーは、組織の RSA キー (Azure RMS テナント キー) によってドキュメントのポリシーの一部として保護されます。このポリシーも、ドキュメントの作成者によって署名されます。 このテナント キーは、Azure RMS によって組織のために保護されているすべてのドキュメントおよび電子メールで共通です。このキーは、ユーザー管理のテナント キー (BYOK (Bring Your Own Key) と呼ばれます) を組織が使用している場合、Azure RMS 管理者だけが変更できます。 

    このテナント キーは、Microsoft のオンライン サービスによって、高度に制御された環境で、厳しい監視の下に保護されています。 ユーザー管理のテナント キー (BYOK) を使用すると、各 Azure リージョンでハイエンド ハードウェア セキュリティ モジュール (HSM) のアレイが使用され、このセキュリティが強化されます。どのような状況でも、キーが抽出、エクスポート、または共有されることはありません。 テナント キーおよび BYOK の詳細については、「[Azure Rights Management テナント キーを計画して実装する](../plan-design/plan-implement-tenant-key.md)」を参照してください。

- Windows デバイスに送信されるライセンスと証明書は、クライアントのデバイス秘密キーによって保護されます。このキーは、デバイスのユーザーが初めて Azure RMS を使用したときに作成されます。 一方、この秘密キーは、クライアント上の DPAPI によって保護されます。DPAPI は、ユーザーのパスワードから派生したキーを使用して、これらのシークレットを保護します。 モバイル デバイスでは、キーは 1 回しか使われず、クライアントに格納されないため、これらのキーをデバイス上で保護する必要はありません。 



## Azure RMS の動作のチュートリアル:初めての使用、コンテンツ保護、コンテンツ消費
Azure RMS の動作方法をさらに詳しく理解するため、[Azure RMS サービスがアクティブ化](../deploy-use/activate-service.md)された後、ユーザーが初めて Windows コンピューターで RMS を使用し (**ユーザー環境の初期化**とも呼ばれます)、**コンテンツ (ドキュメントまたは電子メール) を保護**し、他のユーザーによって保護されているコンテンツを**消費する** (開いて使用する) ときの、一般的なフローを説明します。

ユーザー環境が初期化された後、ユーザーはそのコンピューターでドキュメントを保護したり、保護されているドキュメントを消費したりできます。

> [!NOTE]
> このユーザーが別の Windows コンピューターに移動する場合、または別のユーザーがこの同じ Windows コンピューターを使用する場合は、初期化プロセスが繰り返されます。

### ユーザー環境の初期化
ユーザーが Windows コンピューターでコンテンツを保護したり保護されているコンテンツを消費したりできるためには、その前にデバイスでユーザー環境を準備する必要があります。 これは 1 回限りのプロセスであり、ユーザーがコンテンツの保護または保護されたコンテンツの消費を行おうとしたときに、ユーザーの介入なしに自動的に行われます。

![RMS クライアントのアクティブ化 - 手順 1](../media/AzRMS.png)

**手順 1 の処理**: コンピューターの RMS クライアントは、最初に Azure RMS に接続し、Azure Active Directory アカウントを使用してユーザーを認証します。

ユーザーのアカウントが Azure Active Directory と統合されている場合、この認証は自動的に行われ、ユーザーが資格情報の入力を求められることはありません。

![RMS クライアントのアクティブ化 - 手順 2](../media/AzRMS_useractivation2.png)

**手順 2 の処理**: ユーザー認証の後、接続は組織の RMS テナントに自動的にリダイレクトされます。RMS テナントは、保護されたコンテンツの消費およびコンテンツのオフライン保護のためにユーザーが Azure RMS の認証を受けられるように証明書を発行します。

ユーザーの証明書のコピーは Azure RMS に保存され、ユーザーが別のデバイスに移動した場合は、同じキーを使用して証明書が作成されます。

### コンテンツの保護
ユーザーがドキュメントを保護するとき、RMS クライアントは保護されていないドキュメントに対して次の操作を実行します。

![RMS ドキュメントの保護 - 手順 1](../media/AzRMS_documentprotection1.png)

**手順 1 の処理**: RMS クライアントは、ランダムなキー (コンテンツ キー) を作成し、このキーを使用して、AES 対称暗号化アルゴリズムでドキュメントを暗号化します。

![RMS ドキュメントの保護 - 手順 2](../media/AzRMS_documentprotection2.png)

**手順 2 の処理**: その後、RMS クライアントは、テンプレートに基づき、またはドキュメントに特定の権限を指定することにより、ドキュメントのポリシーを含む証明書を作成します。 このポリシーには、異なるユーザーまたはグループに対する権限、および有効期限などのその他の制限が含まれています。

RMS クライアントは、ユーザー環境の初期化時に取得した組織のキーを使用して、ポリシーおよび対称コンテンツ キーを暗号化します。 また、RMS クライアントは、ユーザーの環境が初期化されたときに取得したユーザーの証明書でポリシーに署名します。

![RMS ドキュメントの保護 - 手順 3](../media/AzRMS_documentprotection3.png)

**手順 3 の処理**: 最後に、RMS クライアントは前に暗号化したドキュメントの本文と共にポリシーをファイルに埋め込みます。これらすべてが、保護されたドキュメントを構成します。

このドキュメントは、任意の場所に保存することも任意の方法を使用して共有することもでき、ポリシーは常に暗号化されたドキュメントと共にあります。

### コンテンツの消費
ユーザーが保護されたドキュメントを消費しようとすると、RMS クライアントは最初に Azure RMS サービスにアクセスを要求します。

![RMS ドキュメントの使用 - 手順 1](../media/AzRMS_documentconsumption1.png)

**手順 1 の処理**: 認証されたユーザーは、ドキュメントのポリシーとユーザーの証明書を Azure RMS に送信します。 サービスはポリシーを復号化して評価し、ユーザーがドキュメントに対して設定している権限のリストを作成します (ある場合)。

![RMS ドキュメントの使用 - 手順 2](../media/AzRMS_documentconsumption2.png)

**手順 2 の処理**: その後、サービスは、復号化されたポリシーから AES コンテンツ キーを抽出します。 このキーは、要求で取得されたユーザーの公開 RSA キーで暗号化されます。

再暗号化されたコンテンツ キーは、ユーザー権利のリストと共に暗号化された使用ライセンスに埋め込まれて、RMS クライアントに返されます。

![RMS ドキュメントの使用 - 手順 3](../media/AzRMS_documentconsumption3.png)

**手順 3 の処理**: 最後に、RMS クライアントは暗号化された使用ライセンスを取得し、独自のユーザー秘密キーで暗号化を解除します。 これにより、RMS クライアントは必要に応じてドキュメント本文の暗号化を解除し、画面に表示できます。

また、クライアントは権限のリストを復号化してアプリケーションに渡します。アプリケーションはユーザー インターフェイスにそれらの権限を適用します。

### バリエーション
前のチュートリアルでは標準的なシナリオをカバーしましたが、いくつかのバリエーションがあります。

-   **モバイル デバイス**:モバイル デバイスが Azure RMS でファイルを保護または消費するときのプロセス フローはとても簡単です。 モバイル デバイスでは、コンテンツを保護または消費するための各トランザクションは独立しているので、ユーザー初期化プロセスは行われません。 Windows コンピューターと同じように、モバイル デバイスは Azure RMS サービスに接続して認証します。 コンテンツを保護する場合、モバイル デバイスはポリシーを送信し、Azure RMS は発行ライセンスとドキュメントを保護する対称キーをモバイル デバイスに送信します。 コンテンツを消費する場合、モバイル デバイスは、Azure RMS サービスに接続して認証するときに、ドキュメントのポリシーを Azure RMS に送信し、ドキュメントを消費するための使用ライセンスを要求します。 応答として、Azure RMS は必要なキーと制限をモバイル デバイスに送信します。 どちらのプロセスも、TLS を使用してキーの交換およびその他の通信を保護します。

-   **RMS コネクタ**:Azure RMS を RMS コネクタで使用するときのプロセス フローは同じです。 唯一の違いは、コネクタがオンプレミス サービス (Exchange Server や SharePoint Server など) と Azure RMS の間のリレーとして機能することです。 コネクタ自体は、ユーザー環境の初期化や暗号化または復号化などのいかなる操作も実行しません。 コネクタは、通常は AD RMS サーバーに送られる通信をリレーするだけであり、両側で使用されているプロトコルの変換を処理します。 このシナリオでは、オンプレミス サービスで Azure RMS を使用できます。

-   **汎用的な保護 (.pfile)**:Azure RMS がファイルを一般的に保護するときは、RMS クライアントがすべての権限を許可するポリシーを作成する点を除けば、フローは基本的にコンテンツ保護と同じです。 ファイルを消費するときは、対象のアプリケーションに渡される前に暗号化が解除されます。 このシナリオでは、RMS をネイティブにサポートしない場合であっても、すべてのファイルを保護できます。

-   **保護された PDF (.ppdf)**:Azure RMS は、Office ファイルをネイティブに保護するときは、そのファイルのコピーも作成して同じ方法で保護します。 唯一の違いは、ファイルのコピーが PPDF ファイル形式であり、RMS 共有アプリケーションは表示するために開く方法だけを認識していることです。 このシナリオでは、保護された添付ファイルを電子メールで送信できます。モバイル デバイスの受信者は、モバイル デバイスに保護された Office ファイルをネイティブにサポートするアプリがない場合であっても、常にファイルを読むことができます。

## 次のステップ

Azure RMS の詳細については、**概要と詳細**のセクションの他の記事を使用してください。たとえば、既存のアプリケーションと Azure RMS を統合して情報保護ソリューションを提供する方法を確認するには、「[アプリケーションで Azure Rights Management をサポートする方法](applications-support.md)」を参照してください。 

「[Azure Rights Management の用語](../get-started/terminology.md)」を確認して、Azure RMS の構成や使用で目にする用語を理解できるようにします。また、デプロイを開始する前に、「[Azure Rights Management の要件](../get-started/requirements-azure-rms.md)」も確認しておいてください。 すぐに自分で試してみる場合は、「[Azure Rights Management のクイック スタート チュートリアル](../get-started/quick-start-tutorial.md)」をご利用ください。

Azure RMS を組織にデプロイする準備ができたら、「[Azure Rights Management の展開ロードマップ](../plan-design/deployment-roadmap.md)」で、デプロイメントの手順と具体的な操作手順へのリンクを参照してください。

> [!TIP]
> 追加情報やサポートが必要な場合は、「[Azure Rights Management の情報とサポート](../get-started/information-support.md)」のリソースとリンクをご利用ください。



<!--HONumber=Jun16_HO4-->


